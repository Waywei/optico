{% extends "layout.html" %}

{% block page_title %}Home{% endblock %}
{% block page_id%}page-home{% endblock %}

{% block carousel %}
<div id="banner"> 
	<ul id="banner_selector">
		{% for c in carousels %}
		<li {% if loop.first %}class="on"{% endif %}>{{ loop.index }}</li>
		{% endfor %}
	</ul>

	<div id="banner_list">
		{% for c in carousels %}
		<a href="{{ c.LinkUrl }}"><img src="{{ c.ImageUrl }}" /></a>
		{% endfor %}
	</div>
</div>
{% endblock %}

{% block body %}

<script type="text/javascript">

var t, total_num, curr_num = 0;

function showAuto() {
	curr_num = (curr_num >= (count-1))? 0: ++curr_num;
	$("#banner li").eq(n).trigger('click');
}

$(document).ready(function(){
	// init
	total_num = $("#banner_list a").length;
	$("#banner_list a:not(:first-child)").hide();

	// click to switch
	$("#banner_selector li").each(function(index){
		curr_num = index;

		if (curr_num >= total_num)
			return;

		$(this).click(function(){
			$("#banner_list a").filter(":visible").fadeOut(300)
				.parent().children().eq(curr_num).fadeIn(400);
			$(this).addClass("on");
			$(this).siblings().removeClass("on");			
		});
	});

	// auto switch
	t = setInterval("showAuto()", 4000);
	$("#banner").hover(function() {
		clearInterval(t);
	}, function() {
		t = setInterval("showAuto()", 4000);
	});
});

</script>

<div class="row">
	{% for mt in mtypes %}
	<div class="mtype-item span3">
		<a href="{{ url_for('mtype', mtype_id=mt.MainTypeID) }}"><img class="mt-image" src="{{ mt.ImageUrl }}" /></a>
		
		<div class="mt-name"><a href="{{ url_for('mtype', mtype_id=mt.MainTypeID) }}">{{ mt.Name }}</a></div>

		<ul class="stypes-list">
			{% for st in mt.stypes %}
			<li><a href="{{ url_for('stype', stype_id=st.SubTypeID) }}">{{ st.Name }}</a></li>
			{% endfor %}
		</ul>
	</div>
	{% endfor %}		
</div>

{% endblock %}